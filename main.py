import winreg
import uuid
from pyuac import main_requires_admin

@main_requires_admin
def main():
    key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, r'SOFTWARE\Microsoft\Cryptography', 0, winreg.KEY_WRITE)
    new_guid = str(uuid.uuid4())
    winreg.SetValueEx(key, 'MachineGuid', 0, winreg.REG_SZ, new_guid)
    winreg.CloseKey(key)

    print(f"New MachineGuid value set to: {new_guid}")

if __name__ == '__main__':
    main()
